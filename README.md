# ccplan

CLI tool to manage `.claude/plans/*.md` files generated by Claude Code's plan mode.

Track status (`draft` / `active` / `done`), list, filter, and clean up plan files — without modifying the files themselves.

## Install

```bash
# npm
npm install -g ccplan

# Bun
bun add -g ccplan

# Single binary (GitHub Releases)
curl -L https://github.com/fujitanisora/ccplan/releases/latest/download/ccplan-darwin-arm64 -o ccplan
chmod +x ccplan
```

## Usage

### `ccplan list`

List plans with status and last updated date.

```bash
ccplan list                    # all plans
ccplan list -s active          # filter by status
ccplan list --json             # JSON output
```

### `ccplan status <file> <status>`

Change a plan's status.

```bash
ccplan status my-plan.md done
ccplan status --latest active  # target most recently modified plan
```

Valid statuses: `draft`, `active`, `done`

### `ccplan open [file]`

Open a plan file in `$EDITOR` (defaults to `vi`).

```bash
ccplan open my-plan.md
ccplan open --latest
```

### `ccplan clean`

Delete plans matching a filter.

```bash
# Batch mode (filter by status + age)
ccplan clean                          # done + 30 days old (default)
ccplan clean --days 7                 # done + 7 days old
ccplan clean -s draft                 # draft + 30 days old
ccplan clean -s draft --all           # all drafts regardless of age
ccplan clean --dry-run                # preview without deleting

# Single file mode (ignores status/age filters)
ccplan clean my-plan.md
ccplan clean --latest
ccplan clean my-plan.md --force       # skip confirmation
```

| Option | Description |
|---|---|
| `-s, --status <status>` | Filter by status (default: `done`) |
| `-d, --days <n>` | Minimum days since updated (default: `30`) |
| `--all` | Remove day limit (cannot combine with `--days`) |
| `-l, --latest` | Target most recently modified plan |
| `--dry-run` | Preview without changes |
| `-f, --force` | Skip confirmation |

## Shell Completion

```bash
# zsh (add to .zshrc)
eval "$(ccplan --completions zsh)"

# bash (add to .bashrc)
eval "$(ccplan --completions bash)"
```

## Metadata Store

Plan metadata is stored in `.claude/plans/.ccplan-meta.json` — plan files are never modified.

```json
{
  "version": 1,
  "plans": {
    "my-plan.md": {
      "status": "active",
      "created": "2026-01-15T10:00:00.000Z",
      "updated": "2026-02-20T12:00:00.000Z"
    }
  }
}
```

Plans without metadata are automatically registered as `active` on first scan.

## Development

```bash
bun install
bun run test
bun run typecheck
bun run lint
bun run build        # dist/index.js (npm package)
bun run build:bin    # ./ccplan (single binary)
```

## License

MIT
