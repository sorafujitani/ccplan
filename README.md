# ccplan

CLI tool to manage `.claude/plans/*.md` files generated by Claude Code's plan mode.

Track status (`draft` / `active` / `done`), list, filter, and clean up plan files — without modifying the files themselves.

## Why

We believe plan documents in agent coding are **ephemeral by nature**. Once a task is complete, the valuable outcomes should be published to Issues, PRs, Wikis, or other durable artifacts — the plan files themselves have served their purpose.

In our view, a tool with a broad user base like Claude Code shouldn't impose an opinionated way to manage these generated files. Users should be free to choose the management approach that fits their workflow. ccplan is one such approach.

Since humans ultimately judge whether work is complete, we find that fully automating a plan's lifecycle is difficult. ccplan aims to give humans a simple way to manage plans in the batches and cadences that make sense to them.

> **Future direction:** We are exploring Agent Skills integration so that agents can assist with plan lifecycle management on behalf of the user.

## Install

```bash
# npm
npm install -g ccplan

# Bun
bun add -g ccplan

# Single binary (GitHub Releases)
curl -L https://github.com/fujitanisora/ccplan/releases/latest/download/ccplan-darwin-arm64 -o ccplan
chmod +x ccplan
```

## Shell Completion (Recommended)

Tab completion for plan filenames, statuses, and options. Highly recommended — no need to remember file names.

Add the following line to your shell config to enable completions permanently:

```bash
# zsh — add to ~/.zshrc
eval "$(ccplan --completions zsh --init)"

# bash — add to ~/.bashrc
eval "$(ccplan --completions bash --init)"
```

Then restart your shell (or `source` the config file).

> **Tip:** Running `ccplan --completions zsh` (without `--init`) will show these setup instructions.

After restarting your shell, the following will be completed:

- `ccplan <TAB>` — subcommands (`list`, `status`, `clean`, `open`)
- `ccplan status <TAB>` — `.claude/plans/*.md` filenames
- `ccplan status file.md <TAB>` — statuses (`draft`, `active`, `done`)
- `ccplan clean <TAB>` — options and filenames

## Usage

### `ccplan list`

List plans with status and last updated date.

```bash
ccplan list                    # all plans
ccplan list -s active          # filter by status
ccplan list --json             # JSON output
```

### `ccplan status <file> <status>`

Change a plan's status.

```bash
ccplan status my-plan.md done
ccplan status --latest active  # target most recently modified plan
```

Valid statuses: `draft`, `active`, `done`

### `ccplan open [file]`

Open a plan file in `$EDITOR` (defaults to `vi`).

```bash
ccplan open my-plan.md
ccplan open --latest
```

### `ccplan clean`

Delete plans matching a filter.

```bash
# Batch mode (filter by status + age)
ccplan clean                          # done + 30 days old (default)
ccplan clean --days 7                 # done + 7 days old
ccplan clean -s draft                 # draft + 30 days old
ccplan clean -s draft --all           # all drafts regardless of age
ccplan clean --dry-run                # preview without deleting

# Single file mode (ignores status/age filters)
ccplan clean my-plan.md
ccplan clean --latest
ccplan clean my-plan.md --force       # skip confirmation
```

| Option | Description |
|---|---|
| `-s, --status <status>` | Filter by status (default: `done`) |
| `-d, --days <n>` | Minimum days since updated (default: `30`) |
| `--all` | Remove day limit (cannot combine with `--days`) |
| `-l, --latest` | Target most recently modified plan |
| `--dry-run` | Preview without changes |
| `-f, --force` | Skip confirmation |

## Metadata Store

Plan metadata is stored in `.claude/plans/.ccplan-meta.json` — plan files are never modified.

```json
{
  "version": 1,
  "plans": {
    "my-plan.md": {
      "status": "active",
      "created": "2026-01-15T10:00:00.000Z",
      "updated": "2026-02-20T12:00:00.000Z"
    }
  }
}
```

Plans without metadata are automatically registered as `active` on first scan.

## Development

```bash
bun install
bun run test
bun run typecheck
bun run lint
bun run build        # dist/index.js (npm package)
bun run build:bin    # ./ccplan (single binary)
```

## Acknowledgements

The name `ccplan` (cc = Claude Code) is inspired by [ccusage](https://github.com/ryoppippi/ccusage).

## License

MIT
